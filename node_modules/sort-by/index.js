<<<<<<< HEAD
var sortBy,
    sort;
=======
var objectPath = require('object-path');
var sortBy;
var sort;
var type;

/**
 * Filters args based on their type
 * @param  {String} type Type of property to filter by
 * @return {Function}
 */
type = function(type) {
    return function(arg) {
        return typeof arg === type;
    };
};
>>>>>>> dev

/**
 * Return a comparator function
 * @param  {String} property The key to sort by
<<<<<<< HEAD
 * @return {Function}        Returns the comparator function
 */
sort = function sort(property) {
    var sortOrder = 1,
        fn;

    if(property[0] === "-") {
=======
 * @param  {Function} map Function to apply to each property
 * @return {Function}        Returns the comparator function
 */
sort = function sort(property, map) {
    var sortOrder = 1;
    var apply = map || function(_, value) { return value };

    if (property[0] === "-") {
>>>>>>> dev
        sortOrder = -1;
        property = property.substr(1);
    }

<<<<<<< HEAD
    fn = function fn(a,b) {
        var result = (a[property] < b[property]) ? -1 : (a[property] > b[property]) ? 1 : 0;
        return result * sortOrder;
    }

    return fn;
=======
    return function fn(a,b) {
        var result;
        var am = apply(property, objectPath.get(a, property));
        var bm = apply(property, objectPath.get(b, property));
        if (am < bm) result = -1;
        if (am > bm) result = 1;
        if (am === bm) result = 0;
        return result * sortOrder;
    }
>>>>>>> dev
};

/**
 * Return a comparator function that sorts by multiple keys
 * @return {Function} Returns the comparator function
 */
sortBy = function sortBy() {
<<<<<<< HEAD
    var props = arguments,
        fn;
    
    fn =  function fn(obj1, obj2) {
        var numberOfProperties = props.length,
=======

    var args = Array.prototype.slice.call(arguments);
    var properties = args.filter(type('string'));
    var map = args.filter(type('function'))[0];

    return function fn(obj1, obj2) {
        var numberOfProperties = properties.length,
>>>>>>> dev
            result = 0,
            i = 0;

        /* try getting a different result from 0 (equal)
         * as long as we have extra properties to compare
         */
        while(result === 0 && i < numberOfProperties) {
<<<<<<< HEAD
            result = sort(props[i])(obj1, obj2);
=======
            result = sort(properties[i], map)(obj1, obj2);
>>>>>>> dev
            i++;
        }
        return result;
    };
<<<<<<< HEAD

    return fn;
};

=======
};

/**
 * Expose `sortBy`
 * @type {Function}
 */
>>>>>>> dev
module.exports = sortBy;